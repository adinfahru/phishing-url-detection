<!DOCTYPE html>
<html>

<head>
  <title>Phishing URL Detection</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/static/styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
  <script src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

  <script type="text/javascript">
    // <![CDATA[
    function loading() {
      $("#loading").show();
      $("#content").hide();
      document.getElementById('loading').style.display = 'block';
      // Create and append the overlay
      var overlay = document.createElement('div');
      overlay.className = 'overlay';
      document.body.appendChild(overlay);
    }

    function hideLoading() {
      document.getElementById('loading').style.display = 'none';
      // Remove the overlay
      var overlay = document.querySelector('.overlay');
      if (overlay) {
        overlay.parentNode.removeChild(overlay);
      }
    }
    window.onload = function () {
      hideLoading();
    };
    // ]]>
  </script>

</head>

<body>
  <div id="loading">
    <div class="scene">
      <div class="shadow"></div>
      <div class="jumper">
        <div class="spinner">
          <div class="scaler">
            <div class="loader">
              <div class="cuboid">
                <div class="cuboid__side"></div>
                <div class="cuboid__side"></div>
                <div class="cuboid__side"></div>
                <div class="cuboid__side"></div>
                <div class="cuboid__side"></div>
                <div class="cuboid__side"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <nav class="navbar bg-body">
    <div class="container">
      <a class="navbar-brand">
        <img src="/static/images/cursor.png" alt="icons" width="74" height="79">
      </a>
    </div>
  </nav>

  <div class="container pt-2">
    <div class="text-center text-lg-start">
      <div class="container">
        <div class="row gx-lg-5 align-items-center">
          <div class="col-lg-6 mb-5 mb-lg-0">
            <h1 class="mb-4 fs-1 fw-bold animate-charcter">Phishing URL Detection <br />
              <span class="text-primary">with Three Different <br> Machine Learning Models</span>
            </h1>
            <p class="desc">
              This is an innovative platform leveraging Machine Learning
              model with Three Different Machine Learning Models to detect phishing and suspicious websites.
              The machine learning model analyzes suspicious URLs, distinguishing between secure links and potential
              phishing traps.
            </p>
          </div>
          <div class="col-lg-6 mb-5 mb-lg-0">
            <div class="card" id="check">
              <div class="card-body" id="form1">
                <div class="text-center mb-5 mt-3">
                  <h5>Let's find out!</h5>
                </div>
                <form action="/#check" method="post">
                  <input type="text" class="form__input form-control" name='url' id="url" placeholder="Enter URL"
                    required="" />
                  <div class="d-grid gap-2">
                    <button class="button btn btn-primary mt-3 fw-bold" role="button" onclick="loading()">Check!</button>
                  </div>
                </form>
                <div class="mt-5">
                  <h5 id="totalResult" class=""></h5>
                  <h6 class="" id="issuer"></h6>
                  <h6 class=""><a href="{{ url }}" target="_blank">{{ url }}</a></h6>
                  <h6 class="disclaimer mt-3" id="disclaimer"></h6>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container mt-5" id="content">
        <div class="mb-4" style="color: #231557;">
          <h5>Result of Three Machine Learning Models : </h5>
        </div>
        <div class="row">
          <div class="col-lg-4">
            <div class="card" id="check">
              <div class="card-body" id="form1">
                <h5>Cat Boost</h5>
                <div class="mt-3">
                  <h5 id="prediction_cat" class=""></h5>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card" id="check">
              <div class="card-body" id="form1">
                <h5>Multi Layer Perceptron</h5>
                <div class="mt-3">
                  <h5 id="prediction_mlp" class=""></h5>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card" id="check">
              <div class="card-body" id="form1">
                <h5>Gradient Boost</h5>
                <div class="mt-3">
                  <h5 id="prediction_gbc" class=""></h5>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="container mt-5 text-center">
          <hr style="border: 1px solid;">
          <div class="mt-5 mb-5" style="color: #231557;">
            <h5>Chart Accuracy After Training Three Machine Learning Models : </h5>
          </div>
          <div class="row">
            <div class="col-lg-12 text-center">
              <canvas id="chart" class="mx-auto" style="max-width: 800px;"></canvas>
            </div>
          </div>
        </div>
      </div>
      <hr>
    </div>
    <!-- Flow -->
    <div class="container mt-5">
      <div class="mb-4" style="color: #231557;">
        <h5>How it works?</h5>
      </div>
      <div class="row row-cols-1 row-cols-md-4 g-4">
        <div class="col">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title fs-6">1. Get The URL from input</h5>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title fs-6">2. Decode the URL</h5>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title fs-6">3. Process by ML</h5>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title fs-6">4. Get the result</h5>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div>
    </div>
    <div class="container my-5" style="margin-top: 50px;">
      <hr style="margin-top: 150px;">
      <footer class="text-center text-lg-start bg-body-tertiary">
        <div class="container p-4 pb-0">
          <section class="">
            <div class="row">
              <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
                <h6 class="text-uppercase mb-4 font-weight-bold">
                  Byte Brigate Team
                </h6>
              </div>
              <hr class="w-100 clearfix d-md-none" />
              <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mt-3">
                <h6 class="text-uppercase mb-4 font-weight-bold">Team Member</h6>
                <h6>Steven Harun Samba</h6>
                <h6>Mohamad Fahrudin</h6>
                <h6>Abiyoga Dhaniswara</h6>
                <h6>Inggit Yeira Budi</h6>
                <h6>Naufal Eka</h6>
              </div>
              <hr class="w-100 clearfix d-md-none" />
              <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mt-3">
                <h6 class="text-uppercase mb-4 font-weight-bold">
                  TSDN 2023
                </h6>
              </div>
              <hr class="w-100 clearfix d-md-none" />
            </div>
          </section>
          <hr class="my-3">
        </div>
      </footer>
    </div>

    <!-- JavaScript -->
    {% block scripts %}
    <script type="text/javascript">
      let gbc_safe_probability = parseFloat('{{ gbc_safe_probability }}');
      let gbc_malicious_probability = parseFloat('{{ gbc_malicious_probability }}');
      let cat_safe_probability = parseFloat('{{ cat_safe_probability }}');
      let cat_malicious_probability = parseFloat('{{ cat_malicious_probability }}');
      let mlp_safe_probability = parseFloat('{{ mlp_safe_probability }}');
      let mlp_malicious_probability = parseFloat('{{ mlp_malicious_probability }}');
      let url = '{{ url }}';
      let showChart = '{{ chart }}';

      // Logika untuk menampilkan disclaimer jika URL hanya mengandung "http"
      if (url.includes("http://")) {
        var disclaimer =
          "<div class='alert alert-warning mt-3' role='alert'> Please note that if a URL contains 'http,' it is considered potentially in-secure, even if the website is well-known. While reputable websites may still use 'http,' this protocol lacks the encryption provided by 'https,' making it less secure for transmitting sensitive information. </div>";
        document.getElementById("disclaimer").innerHTML = disclaimer;
      };

      let total_safe_probability = ((gbc_safe_probability + cat_safe_probability + mlp_safe_probability) / 3).toFixed(2)
      let total_malicious_probability = ((gbc_malicious_probability + cat_malicious_probability +
        mlp_malicious_probability) / 3).toFixed(2)

      if (total_safe_probability <= 100 && total_safe_probability >= 50) {
        var label = "<div class='alert alert-primary mt-3' role='alert'> Average Result :  " + total_safe_probability +
          "% safe </div>";
        document.getElementById("totalResult").innerHTML = label;
      } else if (total_safe_probability >= 0 && total_safe_probability < 50) {
        var label = "<div class='alert alert-danger mt-3' role='alert'> Average Result :  " +
          total_malicious_probability + "% unsafe </div>"
        document.getElementById("totalResult").innerHTML = label;
      };

      // Logika untuk menampilkan hasil prediksi jika URL menggunakan "https"
      if (gbc_safe_probability <= 100 && gbc_safe_probability >= 50) {
        var label = "<div class='alert alert-primary mt-3' role='alert'> Result :  " + gbc_safe_probability +
          "% safe </div>";
        document.getElementById("prediction_gbc").innerHTML = label;
      } else if (gbc_safe_probability >= 0 && gbc_safe_probability < 50) {
        var label = "<div class='alert alert-danger mt-3' role='alert'> Result :  " + gbc_malicious_probability +
          "% unsafe </div>";
        document.getElementById("prediction_gbc").innerHTML = label;
      };

      // Logika untuk menampilkan hasil prediksi jika URL menggunakan "https"
      if (cat_safe_probability <= 100 && cat_safe_probability >= 50) {
        var label = "<div class='alert alert-primary mt-3' role='alert'> Result :  " + cat_safe_probability +
          "% safe </div>";
        document.getElementById("prediction_cat").innerHTML = label;
      } else if (cat_safe_probability >= 0 && cat_safe_probability < 50) {
        var label = "<div class='alert alert-danger mt-3' role='alert'> Result :  " + cat_malicious_probability +
          "% unsafe </div>";
        document.getElementById("prediction_cat").innerHTML = label;
      };

      // Logika untuk menampilkan hasil prediksi jika URL menggunakan "https"
      if (mlp_safe_probability <= 100 && mlp_safe_probability >= 50) {
        var label = "<div class='alert alert-primary mt-3' role='alert'> Result :  " + mlp_safe_probability +
          "% safe </div>";
        document.getElementById("prediction_mlp").innerHTML = label;
      } else if (mlp_safe_probability >= 0 && mlp_safe_probability < 50) {
        var label = "<div class='alert alert-danger mt-3' role='alert'> Result :  " + mlp_malicious_probability +
          "% unsafe </div>";
        document.getElementById("prediction_mlp").innerHTML = label;
      };

      issuer_valid = '{{ issuer_valid }}';
      issued_by = '{{ issued_by }}';

      if (issuer_valid == '1') {
        var label = 'SSL Issuer Trusted!: ' + issued_by;
        document.getElementById("issuer").innerHTML = label;
      } else if (issuer_valid == '0') {
        var label = "SSL Issuer Not Trusted!: " + issued_by;
        document.getElementById("issuer").innerHTML = label;
      } else if (issuer_valid == '-1') {
        var label = "SSL Checking Error! ";
        document.getElementById("issuer").innerHTML = label;
      };
    </script>
    <script type="text/javascript">
      showChart = '{{ chart }}';
      if (showChart == 'True') {

        let gbc_acc_test = '{{ gbc_acc_test }}';
        let cat_acc_test = '{{ cat_acc_test }}';
        let mlp_acc_test = '{{ mlp_acc_test }}';
        const ctx = document.getElementById('chart').getContext('2d');
        var myChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['Cat Boost', 'Multi Layer Percepton', 'Gradient Boost'],
            datasets: [{
              label: 'Highest Accuracy',
              data: [cat_acc_test, mlp_acc_test, gbc_acc_test],
              backgroundColor: [
                'rgba(75, 192, 192, 0.2)',
                'rgba(255, 99, 132, 0.2)',
                'rgba(255, 205, 86, 0.2)'
              ],
              borderColor: [
                'rgba(75, 192, 192, 1)',
                'rgba(255, 99, 132, 1)',
                'rgba(255, 205, 86, 1)'
              ],
              borderWidth: 1
            }]
          },
          options: {
            scales: {
              xAxes: [{
                ticks: {
                  min: 90,
                  max: 100
                }
              }],
              yAxes: [{
                ticks: {
                  min: 90,
                  max: 100
                }
              }]
            }
          }
        });
      }
    </script>
    {% endblock %}
    <!-- ... Any other scripts or closing tags ... -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous">
    </script>


</body>

</html>