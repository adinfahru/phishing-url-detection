<!DOCTYPE html>
<html>

<head>
  <title>Phising URL Detection</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/static/styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
  <script src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
</head>

<body>
  <nav class="navbar bg-body-tertiary">
    <div class="container">
      <a class="navbar-brand">
        <img src="/static/images/cursor.png" alt="icons" width="94" height="99">
      </a>
    </div>
  </nav>

  <div class="container pt-2 bg-body-tertiary">
    <div class="text-center text-lg-start">
      <div class="container">
        <div class="row gx-lg-5 align-items-center">
          <div class="col-lg-6 mb-5 mb-lg-0">
            <h1 class="my-1 mb-4 fs-1 fw-bold">Phishing URL Detection <br />
              <span class="text-primary">with Three Different Machine Learning Models</span>
            </h1>
            <p class="desc">
              This is an innovative platform leveraging Machine Learning
              model with three different machine learning models to detect phishing and suspicious websites.
              The machine learning model analyzes suspicious URLs, distinguishing between secure links and potential phishing traps.
            </p>
          </div>

          <div class="col-lg-6 mb-5 mb-lg-0">
            <div class="card" id="check">
              <div class="card-body" id="form1">
                <div class="text-center mb-5 mt-3">
                  <h5>Let's find out!</h5>
                </div>
                <form action="/#check" method="post">
                  <input type="text" class="form__input form-control" name='url' id="url" placeholder="Enter URL"
                    required="" />
                  <div class="d-grid gap-2">
                    <button class="button btn btn-primary mt-3" role="button" id="buttonScan">Scan</button>
                  </div>
                </form>
                <div class="mt-5">
                  <h5 id="totalResult" class=""></h5>
                  <h6 class=""><a href="{{ url }}" target="_blank">{{ url }}</a></h6>
                  <h6 class="disclaimer mt-3" id="disclaimer"></h6>
                </div>
              </div>
            </div>
          </div>
          
        </div>
      </div>
      <div class="container mt-5">
        <div class="mb-4">
          <h5 class="">Result Three Different Machine Learning Models :</h5>
        </div>
        <div class="row text-center">
          <div class="col-lg-4">
            <div class="card" id="check">
              <div class="card-body" id="form1">
                <h5>Cat Boost</h5>
                <div class="mt-3">
                  <h5 id="prediction_cat" class=""></h5>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card" id="check">
              <div class="card-body" id="form1">
                <h5>Multi Layer</h5>
                <div class="mt-3">
                  <h5 id="prediction_mlp" class=""></h5>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-4">
            <div class="card" id="check">
              <div class="card-body" id="form1">
                <h5>Gradient Boost</h5>
                <div class="mt-3">
                  <h5 id="prediction_gbc" class=""></h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container mt-5">
        <div class="row">
          <div class="col-lg-12">
            <canvas id="chart"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

<!-- JavaScript -->
{% block scripts %}
<script type="text/javascript">
  let gbc_safe_probability = parseFloat('{{ gbc_safe_probability }}');
  let gbc_malicious_probability = parseFloat('{{ gbc_malicious_probability }}');
  let cat_safe_probability = parseFloat('{{ cat_safe_probability }}');
  let cat_malicious_probability = parseFloat('{{ cat_malicious_probability }}');
  let mlp_safe_probability = parseFloat('{{ mlp_safe_probability }}');
  let mlp_malicious_probability = parseFloat('{{ mlp_malicious_probability }}');
  let url = '{{ url }}';
  let showChart = '{{ chart }}'
  
  // Logika untuk menampilkan disclaimer jika URL hanya mengandung "http"
  if (url.includes("http://")) {
      var disclaimer = "Please note that if a URL contains 'http,' it is considered potentially in-secure, even if the website is well-known. While reputable websites may still use 'http,' this protocol lacks the encryption provided by 'https,' making it less secure for transmitting sensitive information.";
      document.getElementById("disclaimer").innerHTML = disclaimer;
  }

  let total_safe_probability = ((gbc_safe_probability + cat_safe_probability + mlp_safe_probability)/3).toFixed(2)
  let total_malicious_probability = ((gbc_malicious_probability + cat_malicious_probability + mlp_malicious_probability)/3).toFixed(2)

  if (total_safe_probability <= 100 && total_safe_probability >= 50) {
      var label = "Average Result :  " + total_safe_probability + "% safe";
      document.getElementById("totalResult").innerHTML = label;
      document.getElementById("totalResult").style.color = "green";
  } else if (total_safe_probability >= 0 && total_safe_probability < 50) {
      var label = "Average Result :  " + total_malicious_probability + "% unsafe"
      document.getElementById("totalResult").innerHTML = label;
      document.getElementById("totalResult").style.color = "red";
  }

  // Logika untuk menampilkan hasil prediksi jika URL menggunakan "https"
  if (gbc_safe_probability <= 100 && gbc_safe_probability >= 50) {
      var label = "Result :  " + gbc_safe_probability + "% safe";
      document.getElementById("prediction_gbc").innerHTML = label;
  } else if (gbc_safe_probability >= 0 && gbc_safe_probability < 50) {
      var label = "Result :  " + gbc_malicious_probability + "% unsafe"
      document.getElementById("prediction_gbc").innerHTML = label;
      document.getElementById("prediction_gbc").style.color = "red";
  }

  // Logika untuk menampilkan hasil prediksi jika URL menggunakan "https"
  if (cat_safe_probability <= 100 && cat_safe_probability >= 50) {
      var label = "Result :  " + cat_safe_probability + "% safe";
      document.getElementById("prediction_cat").innerHTML = label;
  } else if (cat_safe_probability >= 0 && cat_safe_probability < 50) {
      var label = "Result :  " + cat_malicious_probability + "% unsafe"
      document.getElementById("prediction_cat").innerHTML = label;
      document.getElementById("prediction_cat").style.color = "red";
  }

  // Logika untuk menampilkan hasil prediksi jika URL menggunakan "https"
  if (mlp_safe_probability <= 100 && mlp_safe_probability >= 50) {
      var label = "Result :  " + mlp_safe_probability + "% safe";
      document.getElementById("prediction_mlp").innerHTML = label;
  } else if (mlp_safe_probability >= 0 && mlp_safe_probability < 50) {
      var label = "Result :  " + mlp_malicious_probability + "% unsafe"
      document.getElementById("prediction_mlp").innerHTML = label;
      document.getElementById("prediction_mlp").style.color = "red";
  }
  
</script>
<script type="text/javascript">
  showChart = '{{ chart }}'
  if (showChart == 'True') {

    let gbc_acc_test = '{{ gbc_acc_test }}';
    let cat_acc_test = '{{ cat_acc_test }}';
    let mlp_acc_test = '{{ mlp_acc_test }}';
    const ctx = document.getElementById('chart').getContext('2d');
    var myChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Gradient Boost', 'Cat Boost', 'Multi Layer'],
        datasets: [{
          label: 'Accuracy ',
          data: [gbc_acc_test, cat_acc_test, mlp_acc_test],
          backgroundColor: [
            'rgba(75, 192, 192, 0.2)',
            'rgba(255, 99, 132, 0.2)',
            'rgba(255, 205, 86, 0.2)'
          ],
          borderColor: [
            'rgba(75, 192, 192, 1)',
            'rgba(255, 99, 132, 1)',
            'rgba(255, 205, 86, 1)'
          ],
          borderWidth: 1
        }]
      },
      options: {
        scales: {
          xAxes: [{
            ticks: {
              min: 0,
              max: 100
            }
          }]
        }
      }
    });
  }

</script>
{% endblock %}
<!-- ... Any other scripts or closing tags ... -->

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous">
  </script>


</body>

</html>